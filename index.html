<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculateur Prix Vol</title>
</head>
<body>

<h2>✈️ Prix du vol</h2>

<label>Prix avion par heure (€) :</label>
<input type="number" id="prixAvion" value="200"><br>

<label>Temps de vol (minutes) :</label>
<input type="number" id="tempsVol" value="60"><br>

<label>Coût additionnel (€) :</label>
<input type="number" id="coutAdditionnel" value="0"><br>

<label>Nombre de passagers :</label>
<input type="number" id="pax" value="1"><br>

<label><input type="checkbox" id="pilotFFAPilote"> Pilot FFA</label><br><br>

<div id="resultatPax"></div>
<pre id="detailsPax"></pre>

<script>
  const FIXE_PAR_PAX = 18; // commission fixe par passager
  const COMMISSION_RATE = 0.295; // commission variable
  const TVA_RATE = 0.2; // TVA sur commissions

  function updatePrixPax() {
    const prixAvion = parseFloat(document.getElementById('prixAvion').value) || 0;
    const tempsVol = parseFloat(document.getElementById('tempsVol').value) || 0;
    const coutAdditionnel = parseFloat(document.getElementById('coutAdditionnel').value) || 0;
    const pax = parseInt(document.getElementById('pax').value) || 0;
    const pilotFFA = document.getElementById('pilotFFAPilote').checked;

    // Coût vol total HT
    const coutVolBase = (prixAvion / 60) * tempsVol;
    const coutVolTotal = coutVolBase + coutAdditionnel;

    // Répartition parts (classique)
    const totalParts = pax + 1;
    const coutPartHT = coutVolTotal / totalParts;
    const partPiloteHT = coutPartHT;
    const partPassagersHT = coutPartHT * pax;

    // Surcoût FFA (HT, pas de commission/TVA)
    const surcoutPilotFFA = pilotFFA ? 5 * pax : 0;

    // Commissions
    const commissionFixe = FIXE_PAR_PAX * pax;
    const commissionVariable = Math.ceil(partPassagersHT * COMMISSION_RATE);
    const tvaCommissions = Math.ceil((commissionFixe + commissionVariable) * TVA_RATE);

    // Prix TTC total pour les passagers
    const prixTotalPassagers = partPassagersHT + commissionFixe + commissionVariable + tvaCommissions + surcoutPilotFFA;

    // Prix TTC par passager
    const prixPax = prixTotalPassagers / pax;

    // Prix total TTC (pilote + passagers)
    const prixTotal = partPiloteHT + prixTotalPassagers;

    // Affichage
    document.getElementById('resultatPax').innerHTML =
      `Prix par passager : ${prixPax.toFixed(2)} €<br />Prix total : ${prixTotal.toFixed(2)} €`;

    document.getElementById('detailsPax').innerText =
`Détails du calcul :
- Coût vol base (hors TVA) : ${coutVolBase.toFixed(2)} €
- Coût additionnel : ${coutAdditionnel.toFixed(2)} €
- Coût total vol : ${coutVolTotal.toFixed(2)} €
- Parts totales (pilote + pax) : ${totalParts}
- Part pilote (HT) : ${partPiloteHT.toFixed(2)} €
- Part passagers (HT) : ${partPassagersHT.toFixed(2)} €
- Commission fixe : ${commissionFixe} €
- Commission variable (29,5%) arrondie : ${commissionVariable} €
- TVA sur commissions arrondie : ${tvaCommissions} €
- Surcoût Pilot FFA : ${surcoutPilotFFA.toFixed(2)} €
- Prix TTC par passager : ${prixPax.toFixed(2)} €
- Prix total TTC : ${prixTotal.toFixed(2)} €`;
  }

  updatePrixPax();
  document.querySelectorAll('input').forEach(input => {
    input.addEventListener('input', updatePrixPax);
  });
</script>

</body>
</html>
